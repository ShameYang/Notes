# 一、计算机网络概述

## 1.1 基本概念

网络（Network）是由若干结点（Node）和连接这些结点的链路（Link）组成

<img src="https://cdn.jsdelivr.net/gh/ShameYang/images/img/%E7%BD%91%E7%BB%9C.png" style="zoom: 67%;float:left" />



多个网络通过路由器互连起来，构成一个范围更大的网络，即互联网（互连网）(Network of Networks)

<img src="https://cdn.jsdelivr.net/gh/ShameYang/images/img/%E4%BA%92%E8%81%94%E7%BD%91.png" style="zoom: 67%;float:left" />



因特网（Internet）是世界上最大的互连网络

<img src="https://cdn.jsdelivr.net/gh/ShameYang/images/img/%E5%9B%A0%E7%89%B9%E7%BD%91.png" style="zoom:80%;float:left" />



Internet 和 internet 的区别

- Internet（因特网）是一个专用名词，指全球最大的、开放的、由众多网络相互连接而成的特定计算机网络，采用 TCP/IP 协议作为通信的规则，前身是美国的 ARPANET
- internet（互联网或互连网）是一个通用名词，泛指由多个计算机网络互连而成的网络，这些网络间的通信协议是任意的



因特网发展三阶段

<img src="https://cdn.jsdelivr.net/gh/ShameYang/images/img/%E5%9B%A0%E7%89%B9%E7%BD%91%E5%8F%91%E5%B1%95%E4%B8%89%E9%98%B6%E6%AE%B5.png" style="zoom: 50%;float:left" />



ISP

- Internet Service Provider，因特网服务提供者，我国主要有移动、联通、电信

- 基于 ISP 的三层结构的因特网

  <img src="https://cdn.jsdelivr.net/gh/ShameYang/images/img/%E5%9F%BA%E4%BA%8EISP%E7%9A%84%E4%B8%89%E5%B1%82%E7%BB%93%E6%9E%84%E7%9A%84%E5%9B%A0%E7%89%B9%E7%BD%91.png" style="zoom: 80%; float: left;" />



计算机网络的标准化工作

- ISO 国际标准化组织：负责制定大型网络的标准
- ISOC 因特网协会：负责对因特网进行全面管理
  - IAB 架构委员会：负责管理因特网有关协议的开发
    - IETF 工程委员会：针对协议标准化
    - IRTF 研究任务委员会：进行理论方面的研究和开发一些需要长期考虑的问题







## 1.2 因特网的组成

边缘部分

由所有连接在 Internet 上的主机组成，用户可直接用来进行通信（传送数据、视频或音频）和资源共享

- 端系统间的通信方式：

  - C/S 客户端/服务器

    区分服务请求方和服务提供方

  - P2P 对等方式

    不区分服务请求方和服务提供方

核心部分

由大量网络和连接这些网络的路由器（router）组成，为边缘部分提供连通性和交换服务







## 1.3 三种交换方式

> 交换就是按照某种方式动态地分配传输线路的资源

电路交换

- 通话的两个用户始终占用端到端的通信资源，也就是平时打电话的“占线”

- 电路交换的三个步骤
  - 建立连接
  - 通话
  - 释放连接
- 优点：
  - 通信时延小
  - 有序传输
  - 没有冲突
  - 适用范围广
  - 实时性强
  - 控制简单
- 缺点：
  - 建立连接时间长
  - 线路独占，使用效率低
  - 灵活性差
  - 难以规格化

分组交换

- 计算机网络通常采用分组交换

- 报文是网络中交换与传输的数据单元，即站点一次性要发送的数据块

- 分组交换把报文划分成等长的数据段，可以称为“包”，每个数据段前都加上首部（包头）

  - 首部起着关键的作用：由一些控制信息组成，包含目的地址和源地址等重要信息

  - 各部分的任务

    发送方：构造分组、发送分组

    路由器（分组交换机）：存储转发（缓存分组和转发分组）

    接收方：接受分组、还原报文

- 优点：

  - 无需建立连接
  - 线路利用率高
  - 简化了存储管理
  - 加速传输
  - 减少出错率和重复数据量

- 缺点：

  - 引起了转发时延

  - 需要传输额外的信息量

  - 对于数据报服务，存在失序、丢失或重复分组的问题；

    对于虚电路服务，存在呼叫建立、数据传输和虚电路释放的过程

报文交换

- 早期的电报通信网经常使用，现在较少使用，通常被分组交换方式所取代
- 报文交换也采用存储转发的方式，不需要建立专用的通信线路，对报文的大小没有限制
- 优点：
  - 无需建立连接
  - 动态分配线路
  - 提高线路可靠性
  - 提高线路利用率
  - 提供多目标服务
- 缺点：
  - 引起了转发时延
  - 需要较大存储缓存空间
  - 需要传输额外的信息量
  - 只适用于数字信号







## 1.4 计算机网络的分类

按交换技术分类

- 电路交换网络
- 报文交换网络
- 分组交换网络

按使用者分类

- 公用网
- 专用网

按传输介质分类

- 有线网络
- 无线网络

按覆盖范围分类

- 广域网 WAN
- 城域网 MAN
- 局域网 LAN
- 个域网 PAN（无线个人局域网 WPAN）

按拓扑结构分类

拓扑，就是把实体抽象点，连接实体的线路抽象成线

- 总线型网络
- 星型网络
- 环型网络
- 网状型网络







## 1.5 计算机网络的性能指标

速率

- 比特

  - 计算机中数据量的单位

  - 常用数据量单位

    8 bit = 1 Byte

    KB = 2^10 B

    MB = 2^20 B

    GB = 2^30 B

    TB = 2^40 B

- 速率

  - 主机在数字信道上传送比特的速率，称为比特率或数据率

  - 常用数据率单位

    bit/s（b/s，bps）

    kb/s = 10^3 b/s

    Mb/s = 10^6 b/s

    Gb/s = 10^9 b/s

    Tb/s = 10^12 b/s

带宽

- 表示网络的通信线路所能传送数据的能力，因此网络带宽表示在单位时间内从网络的某一点到另一点所能通过的“最高数据率”
- 单位：b/s

吞吐量

- 吞吐量表示在单位时间内通过某个网络的数据量
- 吞吐量受网络的带宽或额定速率的限制

时延

- 发送时延

  - 发送时延 = 分组长度(b) / 发送速率(b/s)

- 传播时延

  - 传播时延 = 信道长度(m) / 电磁波传播速率(m/s)

  - 自由空间：3*10^8 m/s

    铜线：2.3*10^8 m/s

    光纤：2.0*10^8 m/s

- 处理时延（排队时延）

  - 一般不方便计算

时延带宽积

- 时延带宽积 = 传播时延 * 带宽

往返时间（RTT）

利用率

- 信道利用率：表示某信道有百分之几的时间是被利用的（有数据通过）
- 网络利用率：全网络的信道利用率的加权平均
  - 根据排队论，当某信道的利用率增大时，该信道引起的时延也会迅速增加
  - 所以，信道利用率并非越高越好

丢包率

- 丢包率即分组丢失率，指在一定的时间范围内，传输过程中丢失的分组数量与总分组数量的比率
- 丢包率具体可分为接口丢包率、结点丢包率、链路丢包率、路径丢包率、网络丢包率等
- 分组丢失主要有两种情况：
  - 分组在传输过程中出现误码，被结点丢弃
  - 分组到达一台队列已满的分组交换机时被丢弃；在通信量较大时可能造成网络拥塞







## 1.6 计算机网络体系结构

### 1.6.1 常见的计算机体系结构

![](https://cdn.jsdelivr.net/gh/ShameYang/images/img/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84.png)

#### OSI 体系结构

![](https://cdn.jsdelivr.net/gh/ShameYang/images/img/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C-OSI%E5%8F%82%E8%80%83%E6%A8%A1%E5%9E%8B.png)

#### TCP/IP 体系结构

![](https://cdn.jsdelivr.net/gh/ShameYang/images/img/TCPIP%E5%8D%8F%E8%AE%AE.png)



### 1.6.2 分层的必要性

> 在最初的 ARPANET 设计时就提出了分层的概念

计算机网络是个非常复杂的系统

分层可将庞大复杂的问题，转化为若干较小的局部问题，比较易于研究和处理



#### 原理体系结构

![](https://cdn.jsdelivr.net/gh/ShameYang/images/img/%E5%8E%9F%E7%90%86%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84%E5%88%86%E5%B1%82.png)



#### 物理层

采用怎样的传输媒体

采用怎样的物理接口

使用怎样的信号表示比特0和1



#### 数据链路层

如何标识网络中的各主机（主机编址问题，例如 MAC 地址）

如何从比特流中区分出地址和数据

如何协调各主机争用总线



#### 网络层

如何标识各网络以及网络中的主机（网络和主机共同编址的问题，例如 IP 地址）

路由器如何转发分组，如何进行路由选择



#### 运输层

如何解决进程之间基于网络的通信问题

出现传输错误时，如何处理



#### 应用层

通过应用进程间的交互完成特定的网络应用



### 1.6.3 计算机网络体系结构专用术语

#### 实体

实体：任何可发送或接收信息的硬件或软件进程

对等实体：收发双方相同层次中的实体



#### 协议

协议：控制两个对等实体进行逻辑通信的规则的集合

协议三要素：语法、语义、同步

- 语法：定义所交换信息的格式
- 语义：定义收发双方所要完成的操作
- 同步：定义收发双方的时序关系



#### 服务

关于服务：

- 在协议的控制下，两个对等实体间的逻辑通信使得本层能够向上一层提供服务

- 实现本层协议，需要使用下面一层所提供的服务

- 协议是“水平的”，服务是“垂直的”

- 下层的协议对上层“透明”：实体看得见相邻下层提供的服务，但不知道实现该服务的具体协议

服务访问点：在同一系统中，相邻两层的实体交换信息的逻辑接口，用于区分不同的服务类型

- 数据链路层的服务访问点为帧的“类型字段”
- 网络层的服务访问点为 IP 数据报首部的“协议字段”
- 运输层的服务访问点为“端口号”

服务原语：上层使用下层提供的服务，与下层交换一些命令

协议数据单元 PDU：对等层次间传送的数据包

服务数据单元 SDU ：同一系统内，层与层之间交换的数据包







# 二、物理层

## 2.1 物理层的基本概念

物理层考虑怎样能在连接各种计算机的传输媒体上传输数据比特流

物理层为数据链路层屏蔽了各种传输媒体的差异，使其只需考虑如何完成本层的协议和服务



物理层协议的主要任务：

- 机械特性：指明接口所用接线器的**形状**和**尺寸**、**引脚数目**和**排列**、**固定**和锁定装置
- 电气特性：指明在接口电缆的各条线上出现的**电压的范围**
- 功能特性：指明某条线上出现的某一电平的**电压表示的意义**
- 过程特性：指明对于不同功能的各种可能**事件的出现顺序**



## 2.2 物理层下面的传输媒体

传输媒体分为以下两类：

导引型传输媒体

- 同轴电缆

  特点：价格较贵且布线不够灵活方便

  基带同轴电缆（50Ω）过去用于局域网，随着集线器的出现，局域网领域基本上都是采用双绞线

  宽带同轴电缆（75Ω）目前主要用于有线电视

- 双绞线

  双绞线分为无屏蔽双绞线和屏蔽双绞线

  绞合的作用：抵御外界电磁波干扰，减少相邻导线的电磁干扰

- 光纤

  优点

  - 通信容量大
  - 传输损耗小，远距离传输时更经济
  - 抗雷电和电磁干扰性能好
  - 无串音干扰，保密性好，不易被窃听
  - 体积小，重量轻

  缺点

  - 割接需要专用设备
  - 光电接口价格较贵

- 电力线

非导引型传输媒体

- 无线电波

- 微波

  直线传播

- 红外线

- 可见光



## 2.3 传输方式

串行传输

并行传输



同步传输

- 收发双方时钟同步的方法

  外同步：收发双方间添加一条单独的时钟信号线

  内同步：发送端将时钟同步信号编码到发送数据中一起传输（例如曼彻斯特编码）

异步传输

- 字节之间异步（字节之间的时间间隔不固定）
- 字节中的每个比特仍要同步（各比特的持续时间相同）



单向通信（单工）

- 例如：无线电广播

双向交替通信（半双工）

- 例如：对讲机

双向同时通信（全双工）

- 例如：手机



## 2.4 编码与调制

信号：数据的电磁表现

基带信号：信源发出的原始电信号

- 数字基带信号（CPU 与内存之间传输的数字信号）
- 模拟基带信号（麦克风收到声音后产生的音频信号）

信号需要在信道中传播，信道分为：

- 数字信道
- 模拟信道

编码：在不改变信号性质的前提下，仅对基带信号的波形进行变换

- 编码后产生数字信号，在数字信道中传输
- 数字基带信号：以太网（使用曼彻斯特编码、4B/5B、8B/10B 等编码）
- 模拟基带信号：对音频信号进行编码的脉码调制 PCM（将模拟音频信号进行数字化）

调制：把数字基带信号的频率范围搬移到较高的频段，并转换为模拟信号

- 调制后产生模拟信号，在模拟信道中传输
- 数字基带信号：WIFI（CCK/DSSS/OFDM 调制）
- 模拟基带信号：语音数据加载到模拟的载波信号中传输（电话）；频分复用 FDM 技术，充分利用带宽资源

码元：构成信号的一段波形



**常用编码**

不归零编码

归零编码

曼彻斯特编码（传统以太网，10Mb/s）

- 码元中间时刻的跳变既表示时钟，又表示数据

差分曼彻斯特编码（更适合较高的传输速率）

- 码元中间时刻的跳变仅表示时钟
- 码元开始处电平是否发生改变表示数据



## 2.5 信道的极限容量

**奈氏准则**：在假定的理想条件下，为了避免码间串扰，码元传输速率是有上限的

理想低通信道的最高码元传输速率 = 2W Baud = 2W 码元/秒

理想带通信道的最高码元传输速率 = W Baud = W 码元/秒

- W：信道带宽（Hz）
- Baud：波特，即码元/秒

码元传输速率又称为波特率、调制速率、波形速率或符号速率

- 与比特率的关系：bps = Baud * n（n 为1个码元携带比特的数量）



**香农公式**：带宽受限且有高斯白噪声干扰的信道的极限信息传输速率

c = W * log2(1+S/N)

- c：信道的极限信息传输速率

- W：信道带宽（Hz）

- S：信道内所传信号的平均功率

- N：信道内的高斯噪声功率

- S/N：信噪比

  > 注意：S/N 是无单位信噪比，...dB 是有单位的信噪比

  信噪比(dB) = 10 * log10(S/N)

